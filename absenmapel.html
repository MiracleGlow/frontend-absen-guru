<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Absensi Guru Profesional</title>

  <!-- Bootstrap 5.3 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

  <!-- Google Fonts: Poppins -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bs-primary-rgb: 71, 85, 105; /* Slate 600 */
      --bs-primary-light: #f8f9fa; /* Gray 50 */
      --bs-border-radius: 0.5rem;
      --bs-font-sans-serif: 'Poppins', sans-serif;
    }

    body {
      background-color: #f8f9fa;
      font-family: var(--bs-font-sans-serif);
    }

    .main-header {
      border-bottom: 1px solid var(--bs-border-color);
    }

    /* Custom Dropdown Styling */
    .searchable-dropdown {
      position: relative;
    }

    .searchable-dropdown .dropdown-menu-custom {
      display: none;
      position: absolute;
      width: 100%;
      background-color: white;
      border: 1px solid var(--bs-border-color);
      border-radius: var(--bs-border-radius);
      margin-top: 0.25rem;
      box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.1);
      z-index: 1000;
      max-height: 250px;
      overflow-y: auto;
      opacity: 0;
      transform: translateY(-10px);
      transition: opacity 0.2s ease, transform 0.2s ease;
    }

    .searchable-dropdown .dropdown-menu-custom.show {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }
    
    .dropdown-menu-custom .dropdown-item {
        cursor: pointer;
        padding: 0.5rem 1rem;
    }

    .dropdown-menu-custom .filter-input {
      border: none;
      border-bottom: 1px solid var(--bs-border-color);
      border-radius: 0;
    }
    .dropdown-menu-custom .filter-input:focus {
        box-shadow: none;
    }
    
    /* Jadwal Card Styling */
    #jadwal-grid {
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
    }
    #jadwal-grid.visible {
        opacity: 1;
    }

    .jadwal-card {
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      border: 1px solid var(--bs-border-color);
      height: 100%;
    }
    
    .jadwal-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.1) !important;
    }

    /* Status Backgrounds with smooth transitions */
    .card-body {
        transition: background-color 0.3s ease;
    }
    .status-hadir { background-color: rgba(25, 135, 84, 0.05); }
    .status-izin { background-color: rgba(255, 193, 7, 0.1); }
    .status-sakit { background-color: rgba(13, 202, 240, 0.1); }
    .status-alfa { background-color: rgba(220, 53, 69, 0.05); }

    .form-control::placeholder {
        color: #6c757d;
        opacity: 0.8;
    }
    
  </style>
</head>
<body>

  <div class="container my-4 my-sm-5">
    <!-- Header -->
    <header class="d-flex flex-column flex-sm-row justify-content-between align-items-center pb-3 mb-4 main-header">
      <h1 class="h3 fw-bold text-slate-800 mb-2 mb-sm-0">
        <i class="bi bi-calendar-check me-2"></i>Absensi Guru Harian
      </h1>
      <p class="text-muted small mb-0">
        <i class="bi bi-clock me-1"></i><span id="tanggal"></span>
      </p>
    </header>

    <!-- Pilih Kelas + Jurusan (Searchable Dropdown) -->
    <div class="searchable-dropdown mb-4">
      <label for="search-input" class="form-label fw-semibold">Pilih Kelas & Jurusan</label>
      <input
        id="search-input"
        type="text"
        placeholder="Klik untuk memilih atau cari kelas..."
        class="form-control form-control-lg"
        readonly
        style="cursor: pointer;"
      />
      <div id="dropdown-list" class="dropdown-menu-custom">
        <input id="filter-input" type="text" placeholder="Cari kelas..." class="form-control filter-input p-2 mb-1" />
        <div id="options-container"></div>
      </div>
    </div>

    <!-- Grid Jadwal -->
    <div id="jadwal-grid" class="d-none">
      <h2 id="judul-jadwal" class="h4 fw-semibold mb-4 text-slate-800"></h2>
      <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-4" id="grid-container">
        <!-- Jadwal cards will be inserted here by JavaScript -->
      </div>

      <div class="mt-4 pt-4 border-top d-flex justify-content-end">
        <button id="simpan-button" class="btn btn-primary btn-lg">
          <i class="bi bi-save me-2"></i>Simpan Absensi
        </button>
      </div>
    </div>
  </div>

  <script>
    // --- DATA ---
    const daftarKelasJurusan = [
      "X RPL", "XI RPL", "XII RPL",
      "X TKJ", "XI TKJ", "XII TKJ",
      "X AKL", "XI AKL", "XII AKL",
      "X MPLB", "XI MPLB", "XII MPLB",
      "X PM", "XI PM", "XII PM"
    ];

    const jadwalData = {
      "XII RPL": [
        { jam: 1, guru: "Budi Santoso", mapel: "Pemrograman Berorientasi Objek" },
        { jam: 2, guru: "Budi Santoso", mapel: "Pemrograman Berorientasi Objek" },
        { jam: 3, guru: "Dewi Lestari", mapel: "Bahasa Inggris" },
        { jam: 4, guru: "Andi Wijaya", mapel: "Basis Data" },
        { jam: 5, guru: "Andi Wijaya", mapel: "Basis Data" },
        { jam: 6, guru: "Tono Prasetyo", mapel: "Produk Kreatif & KWU" },
        { jam: 7, guru: "Siti Rahma", mapel: "Pendidikan Agama" },
        { jam: 8, guru: "Siti Rahma", mapel: "Pendidikan Agama" },
        { jam: 9, guru: "Budi Santoso", mapel: "Pemrograman Berorientasi Objek" }
      ],
      "XI TKJ": [
        { jam: 1, guru: "Herman Susilo", mapel: "Teknologi Jaringan" },
        { jam: 2, guru: "Herman Susilo", mapel: "Teknologi Jaringan" },
        { jam: 3, guru: "Dewi Lestari", mapel: "Bahasa Inggris" },
        { jam: 4, guru: "Rina Marlina", mapel: "Administrasi Sistem Jaringan" },
        { jam: 5, guru: "Rina Marlina", mapel: "Administrasi Sistem Jaringan" },
        { jam: 6, guru: "Tono Prasetyo", mapel: "Produk Kreatif & KWU" },
        { jam: 7, guru: "Siti Rahma", mapel: "Pendidikan Agama" },
        { jam: 8, guru: "Herman Susilo", mapel: "Teknologi Jaringan" },
      ]
      // Tambahkan data jadwal lain di sini...
    };

    // --- Inisialisasi Tampilan ---
    document.getElementById("tanggal").textContent = new Date().toLocaleDateString("id-ID", {
      weekday: "long", year: "numeric", month: "long", day: "numeric"
    });

    // --- Elemen DOM ---
    const searchInput = document.getElementById("search-input");
    const dropdownList = document.getElementById("dropdown-list");
    const filterInput = document.getElementById("filter-input");
    const optionsContainer = document.getElementById("options-container");
    const jadwalGrid = document.getElementById("jadwal-grid");
    const gridContainer = document.getElementById("grid-container");
    const judulJadwal = document.getElementById("judul-jadwal");

    // --- Fungsionalitas Dropdown Kustom ---
    function populateDropdown() {
        optionsContainer.innerHTML = ''; // Clear existing options
        daftarKelasJurusan.forEach(kj => {
            const optionEl = document.createElement("div");
            optionEl.textContent = kj;
            optionEl.className = "dropdown-item";
            optionEl.addEventListener("click", () => {
                searchInput.value = kj;
                closeDropdown();
                tampilkanJadwal(kj);
            });
            optionsContainer.appendChild(optionEl);
        });
    }

    function filterOptions(keyword) {
      const allOptions = optionsContainer.querySelectorAll(".dropdown-item");
      allOptions.forEach(option => {
        const text = option.textContent.toLowerCase();
        option.style.display = text.includes(keyword.toLowerCase()) ? "block" : "none";
      });
    }

    function openDropdown() {
      dropdownList.classList.add("show");
      filterInput.value = '';
      filterOptions('');
      setTimeout(() => filterInput.focus(), 100); // Fokus setelah transisi
    }

    function closeDropdown() {
      dropdownList.classList.remove("show");
    }

    searchInput.addEventListener("click", () => {
      if (dropdownList.classList.contains("show")) {
        closeDropdown();
      } else {
        openDropdown();
      }
    });

    filterInput.addEventListener("input", e => filterOptions(e.target.value));

    document.addEventListener("click", e => {
      if (!searchInput.contains(e.target) && !dropdownList.contains(e.target)) {
        closeDropdown();
      }
    });

    // --- Fungsionalitas Tampilan Jadwal ---
    function tampilkanJadwal(kelasJurusan) {
      const data = jadwalData[kelasJurusan];
      gridContainer.innerHTML = "";

      if (!data) {
        jadwalGrid.classList.add("d-none");
        jadwalGrid.classList.remove("visible");
        alert(`Belum ada data jadwal untuk kelas ${kelasJurusan}.`);
        return;
      }
      
      judulJadwal.innerHTML = `<i class="bi bi-table me-2"></i>Jadwal Kelas ${kelasJurusan}`;
      jadwalGrid.classList.remove("d-none");
      setTimeout(() => jadwalGrid.classList.add("visible"), 10); // Trigger fade-in

      data.forEach(item => {
        const col = document.createElement("div");
        col.className = "col";
        col.innerHTML = `
          <div class="card shadow-sm jadwal-card">
            <div class="card-body status-hadir">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <h6 class="card-subtitle text-muted">Jam ke-${item.jam}</h6>
              </div>
              <p class="mb-1">
                <i class="bi bi-person-fill text-muted me-2"></i>
                <span class="fw-semibold">${item.guru}</span>
              </p>
              <p class="mb-3 small text-muted">
                <i class="bi bi-book text-muted me-2"></i>${item.mapel}
              </p>
              <select class="form-select form-select-sm absen-dropdown mb-2">
                <option value="Hadir" selected>Hadir</option>
                <option value="Izin">Izin</option>
                <option value="Sakit">Sakit</option>
                <option value="Alfa">Alfa (Tanpa Keterangan)</option>
              </select>
              <input type="text" class="form-control form-control-sm keterangan d-none" placeholder="Tulis keterangan..." />
            </div>
          </div>
        `;
        gridContainer.appendChild(col);
      });

      setupCardInteractions();
    }

    function setupCardInteractions() {
      document.querySelectorAll(".absen-dropdown").forEach(select => {
        select.addEventListener("change", (e) => {
          const cardBody = e.target.closest('.card-body');
          const keteranganInput = cardBody.querySelector(".keterangan");
          
          // Hapus kelas status lama
          cardBody.classList.remove("status-hadir", "status-izin", "status-sakit", "status-alfa");
          
          // Tambah kelas status baru
          const statusMap = { "Hadir": "status-hadir", "Izin": "status-izin", "Sakit": "status-sakit", "Alfa": "status-alfa" };
          cardBody.classList.add(statusMap[e.target.value]);
          
          // Tampilkan input keterangan
          if (e.target.value !== "Hadir") {
            keteranganInput.classList.remove("d-none");
            keteranganInput.focus();
          } else {
            keteranganInput.classList.add("d-none");
            keteranganInput.value = "";
          }
        });
      });
    }

    // --- Event Listener Tombol Simpan ---
    document.getElementById("simpan-button").addEventListener("click", () => {
      // Logika untuk mengumpulkan data bisa ditambahkan di sini
      alert("Data absensi berhasil disimpan! (Simulasi)");
    });
    
    // --- Inisialisasi awal ---
    populateDropdown();

  </script>

</body>
</html>